webpackJsonp([28],{"5MtI":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("Xxa5"),s=a.n(l),r=a("exGp"),o=a.n(r),i=a("4w6b"),n=a("YMRc"),c={mixins:[a("UWZQ").a],props:{visible:{type:Boolean,default:!1}},data:function(){return{searchForm:{loginName:"",userName:"",userEmail:"",userMobile:"",userPhone:""},asyncFunc:i.p,dialogVisible:!1,selectRows:[]}},watch:{visible:function(e){this.dialogVisible=e}},methods:{selChange:function(e){this.selectRows=e},delSel:function(e){this.$refs.table.toggleRowSelection(e,!1)},submit:function(){var e=this;return o()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a={roleUuid:e.$route.query.uuid,userUuidList:e.selectRows.map(function(e){return e.uuid})},t.next=3,Object(n.e)(a);case 3:"0000"===t.sent.code&&(e.$message({type:"success",message:"操作成功"}),e.clearSel(),e.$emit("refresh"),e.$emit("update:visible",!1));case 5:case"end":return t.stop()}},t,e)}))()},close:function(){this.clearSel(),this.$emit("update:visible",!1)},clearSel:function(){this.$refs.table.clearSelection()}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.dialogVisible,"before-close":e.close,title:"用户选择",top:"8vh",width:"90%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"main"},[a("el-form",{ref:"form",staticClass:"jee-search-form",attrs:{model:e.searchForm,inline:""}},[a("el-form-item",{attrs:{label:"账号:"}},[a("el-input",{attrs:{size:"small"},model:{value:e.searchForm.loginName,callback:function(t){e.$set(e.searchForm,"loginName",t)},expression:"searchForm.loginName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名:"}},[a("el-input",{attrs:{size:"small"},model:{value:e.searchForm.userName,callback:function(t){e.$set(e.searchForm,"userName",t)},expression:"searchForm.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱:"}},[a("el-input",{attrs:{size:"small"},model:{value:e.searchForm.userEmail,callback:function(t){e.$set(e.searchForm,"userEmail",t)},expression:"searchForm.userEmail"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机:"}},[a("el-input",{attrs:{size:"small"},model:{value:e.searchForm.userMobile,callback:function(t){e.$set(e.searchForm,"userMobile",t)},expression:"searchForm.userMobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"电话:"}},[a("el-input",{attrs:{size:"small"},model:{value:e.searchForm.userPhone,callback:function(t){e.$set(e.searchForm,"userPhone",t)},expression:"searchForm.userPhone"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.search}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.reset}},[e._v("重置")])],1)],1),e._v(" "),a("el-row",{directives:[{name:"auto-height",rawName:"v-auto-height"}],attrs:{gutter:10}},[a("el-col",{staticClass:"relative",attrs:{span:20}},[a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"100%",border:"",stripe:"","row-key":"uuid"},on:{"selection-change":e.selChange}},[a("el-table-column",{attrs:{type:"index",label:" ",align:"center",width:"45"}}),e._v(" "),a("el-table-column",{attrs:{type:"selection","reserve-selection":"",align:"center",width:"45"}}),e._v(" "),a("el-table-column",{attrs:{prop:"loginName",label:"账号",align:"center",width:"180","show-overflow-tooltip":"",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"用户名",align:"center",width:"180","show-overflow-tooltip":"",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"userEmail",align:"center",label:"电子邮箱","show-overflow-tooltip":"",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"userMobile",align:"center",label:"手机号码","show-overflow-tooltip":"",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"userPhone",align:"center",label:"办公电话","show-overflow-tooltip":"",sortable:""}})],1)],1),e._v(" "),a("el-col",{staticClass:"relative",attrs:{span:4}},[a("div",{staticClass:"selection"},[e._v("\n          已选择用户 "+e._s(e.selectRows.length)+" ："),a("br"),e._v(" "),e._l(e.selectRows,function(t,l){return a("el-tag",{key:l,attrs:{closable:""},on:{close:function(a){e.delSel(t)}}},[e._v("\n            "+e._s(t.loginName)+"\n          ")])})],2)])],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.current,"page-sizes":e.sizes,"page-size":e.size,total:e.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.sizeChange,"current-change":e.pageChange}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submit}},[e._v("确 定")])],1)])},staticRenderFns:[]};var m={name:"RoleUser",components:{addUserDialog:a("VU/8")(c,u,!1,function(e){a("i2OR")},"data-v-621daad2",null).exports},data:function(){return{searchForm:{roleName:"",roleCode:"",roleType:"",sysFlag:"",roleStatus:""},showSearch:!1,tableData:[],loading:!1,dialogVisible:!1,role:{},selUsers:[]}},mounted:function(){this.$route.query.uuid?(this.getTableData(),this.getDetail()):this.jumpRouterCachedView(this.$route,{path:"/sys/role"})},methods:{add:function(){this.dialogVisible=!0},select:function(e){this.selUsers=e},getDetail:function(){var e=this;return o()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(n.x)({roleUuid:e.$route.query.uuid});case 2:"0000"===(a=t.sent).code&&a.data&&(e.role=a.data);case 4:case"end":return t.stop()}},t,e)}))()},getTableData:function(){var e=this;return o()(s.a.mark(function t(){var a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(n.t)({roleUuid:e.$route.query.uuid});case 3:a=t.sent,e.loading=!1,"0000"===a.code&&a.data&&(e.tableData=a.data);case 6:case"end":return t.stop()}},t,e)}))()},cancel:function(e){var t=this;this.$confirm("确认要取消该用户角色吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.cancelRoleUser([e])})},cancels:function(){var e=this;this.selUsers.length?this.$confirm("确认要取消列表中权重的用户角色权限吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.cancelRoleUser(e.selUsers)}):this.$message({type:"info",message:"请选择用户"})},cancelRoleUser:function(e){var t=this;return o()(s.a.mark(function a(){var l;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return l={roleUuid:t.$route.query.uuid,userUuidList:e.map(function(e){return e.uuid})},a.next=3,Object(n.g)(l);case 3:"0000"===a.sent.code&&(t.$message({type:"success",message:"授权取消成功!"}),t.getTableData());case 5:case"end":return a.stop()}},a,t)}))()},close:function(){this.jumpRouterCachedView(this.$route,{path:"/sys/role"})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"jee-page"},[a("div",{staticClass:"jee-header"},[a("div",{staticClass:"jee-title"},[a("i",{class:e.$route.meta.icon}),e._v(" "+e._s(e.$route.meta.title)+" ("+e._s(e.role.roleName)+")")]),e._v(" "),a("div",{staticClass:"jee-tools"},[a("el-button",{attrs:{icon:"fa fa-plus",size:"small"},on:{click:e.add}},[e._v(" 添加用户")]),e._v(" "),a("el-button",{attrs:{icon:"fa fa-remove",size:"small"},on:{click:e.cancels}},[e._v(" 批量取消")]),e._v(" "),a("el-button",{attrs:{icon:"fa fa-reply-all",size:"small"},on:{click:e.close}},[e._v(" 关闭")])],1)]),e._v(" "),a("div",{staticClass:"jee-body"},[a("div",{directives:[{name:"auto-height",rawName:"v-auto-height"}],staticClass:"jee-table-box"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:"",height:"100%"},on:{"selection-change":e.select}},[a("el-table-column",{attrs:{type:"index",label:" ",align:"center",width:"45"}}),e._v(" "),a("el-table-column",{attrs:{type:"selection",align:"center",width:"45"}}),e._v(" "),a("el-table-column",{attrs:{prop:"loginName",align:"center",label:"账号","show-overflow-tooltip":"",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",align:"center",label:"用户名","show-overflow-tooltip":"",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"userEmail",align:"center",label:"电子邮箱","show-overflow-tooltip":"",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"userMobile",align:"center",label:"手机号码","show-overflow-tooltip":"",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"userPhone",align:"center",label:"办公电话","show-overflow-tooltip":"",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"userStatus",align:"center","min-width":"127",label:"状态",width:"92","show-overflow-tooltip":"",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return["0"===t.row.userStatus?a("span",[e._v("正常")]):e._e(),e._v(" "),"2"===t.row.userStatus?a("span",[e._v("停用")]):e._e(),e._v(" "),"3"===t.row.userStatus?a("span",[e._v("冻结")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"149",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{"open-delay":400,effect:"light",content:"取消授权",placement:"bottom-start"}},[a("el-button",{attrs:{type:"primary-text",icon:"fa fa-remove"},on:{click:function(a){e.cancel(t.row)}}})],1)]}}])})],1)],1)]),e._v(" "),a("add-user-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},refresh:e.getTableData}})],1)},staticRenderFns:[]};var h=a("VU/8")(m,d,!1,function(e){a("EnLD")},"data-v-7e347d9a",null);t.default=h.exports},EnLD:function(e,t){},i2OR:function(e,t){}});