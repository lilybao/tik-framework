webpackJsonp([10],{"29Sh":function(e,t){},EgqA:function(e,t){},GkhE:function(e,t,r){"use strict";var a=r("Xxa5"),n=r.n(a),s=r("exGp"),o=r.n(s),i=r("M4fF"),l=r.n(i),c=r("YMRc"),u=r("4w6b"),d=r("t5DY"),f=r("RbaZ"),h={props:{isEdit:{type:Boolean,default:!1}},data:function(){return{form:{loginName:"",userName:""},treeData:[],treeProp:{children:"children",label:"orgName"},loading:!1,rolesAll:[],selRoles:[]}},mounted:function(){var e=this;return o()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getOrgList();case 2:return t.next=4,e.getRolesAll();case 4:e.initForm();case 5:case"end":return t.stop()}},t,e)}))()},methods:{initForm:function(){this.$refs.form.resetFields(),this.$route.query.uuid?(this.getDetail(this.$route.query.uuid),this.isEdit&&this.getOrgAdminAuth()):this.jumpRouterCachedView(this.$route,{path:"/sys/org-admin"})},getOrgAdminAuth:function(){var e=this;return o()(n.a.mark(function t(){var r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.w)({userUuid:e.$route.query.uuid});case 2:"0000"===(r=t.sent).code&&(r.data.orgAdminOrgList&&e.$refs.tree.setCheckedKeys(r.data.orgAdminOrgList.map(function(e){return e.orgUuid})),r.data.orgAdminRoleList&&r.data.orgAdminRoleList.forEach(function(t){var r=l.a.find(e.rolesAll,function(e){return e.uuid===t.roleUuid});r&&e.$refs.table.toggleRowSelection(r)}));case 4:case"end":return t.stop()}},t,e)}))()},getDetail:function(e){var t=this;return o()(n.a.mark(function r(){var a,s;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(u.o)({userUuid:e});case 2:if("0000"===(a=r.sent).code&&a.data)for(s in a.data)a.data.hasOwnProperty(s)&&null!==a.data[s]&&(t.form[s]=a.data[s]);case 4:case"end":return r.stop()}},r,t)}))()},getOrgList:function(){var e=this;return o()(n.a.mark(function t(){var r,a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(d.c)();case 2:r=t.sent,a=Object(f.a)(r.data),e.treeData=[{uuid:0,orgName:"全部",children:a}];case 5:case"end":return t.stop()}},t,e)}))()},getRolesAll:function(){var e=this;return o()(n.a.mark(function t(){var r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.r)();case 2:"0000"===(r=t.sent).code&&(e.rolesAll=r.data);case 4:case"end":return t.stop()}},t,e)}))()},selChange:function(e){this.selRoles=e},save:function(){var e=this;return o()(n.a.mark(function t(){var r,a,s;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.$refs.tree.getHalfCheckedKeys().filter(function(e){return 0!==e}),a={userUuid:e.$route.query.uuid,orgUuidList:e.$refs.tree.getCheckedKeys().filter(function(e){return 0!==e}).concat(r),roleUuidList:e.selRoles.map(function(e){return e.uuid})},e.loading=!0,t.next=5,Object(c.z)(a);case 5:if(s=t.sent,e.loading=!1,"0000"===s.code){t.next=9;break}return t.abrupt("return");case 9:e.jumpRouterView(e.$route,{path:"/sys/org-admin"});case 10:case"end":return t.stop()}},t,e)}))()},close:function(){this.jumpRouterCachedView(this.$route,{path:"/sys/org-admin"})},foldTree:function(){this.toggleTree(!1)},openTree:function(){this.toggleTree(!0)},toggleTree:function(e){for(var t=0;t<this.$refs.tree.store._getAllNodes().length;t++)this.$refs.tree.store._getAllNodes()[t].expanded=e},handleCheckChange:function(e,t,r){console.log(e,t,r)}}},m={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px",size:"small"}},[r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{offset:1,span:10}},[r("el-form-item",{attrs:{label:"账号："}},[r("el-input",{attrs:{placeholder:"请填写",disabled:""},model:{value:e.form.loginName,callback:function(t){e.$set(e.form,"loginName",t)},expression:"form.loginName"}})],1)],1),e._v(" "),r("el-col",{attrs:{offset:1,span:10}},[r("el-form-item",{attrs:{label:"用户名："}},[r("el-input",{attrs:{placeholder:"请填写",disabled:""},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1)],1)],1),e._v(" "),r("div",{staticClass:"jee-form-title"},[e._v("可管理的机构")]),e._v(" "),r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"box-card-header clearfix",attrs:{slot:"header"},slot:"header"},[r("span",{staticClass:"fl"},[e._v("机构权限")]),e._v(" "),r("div",{staticClass:"fr"},[r("span",{on:{click:e.openTree}},[e._v("展开")]),e._v(" / "),r("span",{on:{click:e.foldTree}},[e._v("折叠")])])]),e._v(" "),r("el-tree",{ref:"tree",attrs:{data:e.treeData,props:e.treeProp,"default-expanded-keys":[0],"node-key":"uuid","show-checkbox":""},on:{"check-change":e.handleCheckChange}})],1),e._v(" "),r("div",{staticClass:"jee-form-title"},[e._v("可分配的角色")]),e._v(" "),r("div",{staticClass:"second-section"},[r("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.rolesAll,border:"",stripe:""},on:{"selection-change":e.selChange}},[r("el-table-column",{attrs:{type:"selection",align:"center",width:"50"}}),e._v(" "),r("el-table-column",{attrs:{prop:"roleName",align:"center",label:"角色名称"}}),e._v(" "),r("el-table-column",{attrs:{prop:"roleCode",align:"center",label:"角色编码"}})],1)],1),e._v(" "),r("el-row",{staticClass:"jee-submit-buttons"},[r("el-col",{attrs:{offset:1,span:21}},[r("el-button",{attrs:{loading:e.loading,type:"primary",icon:"fa fa-check",size:"small"},on:{click:e.save}},[e._v("  保 存\n      ")]),e._v(" "),r("el-button",{attrs:{icon:"fa fa-reply-all",size:"small"},on:{click:e.close}},[e._v("  关 闭")])],1)],1)],1)},staticRenderFns:[]};var p=r("VU/8")(h,m,!1,function(e){r("EgqA")},"data-v-6be50ba6",null);t.a=p.exports},fgJE:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={name:"OrgAdminEdit",components:{infoForm:r("GkhE").a}},n={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"jee-page"},[t("div",{staticClass:"jee-header"},[t("div",{staticClass:"jee-title"},[t("i",{class:this.$route.meta.icon}),this._v(" "+this._s(this.$route.meta.title))])]),this._v(" "),t("div",{staticClass:"jee-body"},[t("info-form",{attrs:{"is-edit":""}})],1)])},staticRenderFns:[]};var s=r("VU/8")(a,n,!1,function(e){r("29Sh")},"data-v-65befc02",null);t.default=s.exports}});