webpackJsonp([43],{"I/Fm":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("Xxa5"),r=a.n(o),s=a("exGp"),n=a.n(s),l=a("zM1N"),c=a.n(l),i=a("p+m2"),u=a("oDnd"),p=a("4w6b"),m=a("t5DY"),f={name:"Org",components:{VTreeTable:i.a,treeColumn:u.a},data:function(){return{orgTypeList:[],searchForm:{},searchFormTemp:{},pageIndex:1,tableData:[],showSearch:!1,loading:!1}},created:function(){var e=this;return n()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.getOrgTypeList(),e.getTableData();case 2:case"end":return t.stop()}},t,e)}))()},methods:{query:function(e){this.searchFormTemp=c()(e),this.getTableData()},getOrgTypeList:function(){var e=this;return n()(r.a.mark(function t(){var a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.b)("sys_org_type");case 2:"0000"===(a=t.sent).code&&(e.orgTypeList=a.data||[]);case 4:case"end":return t.stop()}},t,e)}))()},getTableData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.searchFormTemp;return n()(r.a.mark(function a(){var o;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.loading=!0,a.next=3,Object(p.d)(t);case 3:o=a.sent,e.loading=!1,"0000"===o.code&&(e.tableData=o.data);case 6:case"end":return a.stop()}},a,e)}))()},expendAll:function(){this.$refs.treeTable.expendNode()},closeAll:function(){this.$refs.treeTable.closeNode()},handleNodeClick:function(e){console.log(e)},goAddOrg:function(e){var t=e.uuid,a=e.orgName;if(t&&a)this.$router.push("/sys/org/add?parentUuid="+t+"&orgName="+a);else{var o=(new Date).getTime();this.$router.push("/sys/org/add?t="+o)}},goEditOrg:function(e){this.$router.push("/sys/org/edit?uuid="+e)},stopOrg:function(e){var t=this;this.$confirm("此操作将停用该机构, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(n()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(p.f)({uuid:e,orgStatus:"2"});case 2:"0000"===a.sent.code&&(t.$message({type:"success",message:"停用成功!"}),t.getTableData());case 4:case"end":return a.stop()}},a,t)}))).catch(function(){t.$message({type:"info",message:"已取消停用"})})},startOrg:function(e){var t=this;this.$confirm("此操作将启用该机构, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(n()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(p.f)({uuid:e,orgStatus:"0"});case 2:"0000"===a.sent.code&&(t.$message({type:"success",message:"启用成功!"}),t.getTableData());case 4:case"end":return a.stop()}},a,t)}))).catch(function(){t.$message({type:"info",message:"已取消启用"})})},delOrg:function(e){var t=this;this.$confirm("此操作将永久删除该机构, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(n()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(p.b)({orgUuid:e});case 2:"0000"===a.sent.code&&(t.$message({type:"success",message:"删除成功!"}),t.getTableData());case 4:case"end":return a.stop()}},a,t)}))).catch(function(){t.$message({type:"info",message:"已取消删除"})})},resetForm:function(){this.searchForm={},this.query({})},queryData:function(){this.$message({message:"查询成功",type:"success"})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"jee-page org-container"},[a("div",{staticClass:"jee-header"},[a("div",{staticClass:"jee-title"},[a("i",{class:e.$route.meta.icon}),e._v(" "+e._s(e.$route.meta.title))]),e._v(" "),a("div",{staticClass:"jee-tools"},[a("el-button",{attrs:{icon:"fa fa-filter",size:"small"},on:{click:function(t){e.showSearch=!e.showSearch}}},[e._v(" "+e._s(e.showSearch?"隐藏":"查询")+"\n      ")]),e._v(" "),a("el-button",{attrs:{icon:"fa fa-angle-double-down",size:"small"},on:{click:e.expendAll}},[e._v(" 展开")]),e._v(" "),a("el-button",{attrs:{icon:"fa fa-angle-double-up",size:"small"},on:{click:e.closeAll}},[e._v(" 折叠")]),e._v(" "),e.$permission["sys:org:add"]?a("el-button",{attrs:{icon:"fa fa-plus",size:"small"},on:{click:e.goAddOrg}},[e._v(" 新增")]):e._e()],1)]),e._v(" "),a("div",{staticClass:"jee-body"},[e.showSearch?a("el-form",{ref:"form",staticClass:"jee-search-form",attrs:{model:e.searchForm,inline:""}},[a("el-form-item",{attrs:{label:"机构代码："}},[a("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"请填写",size:"small",clearable:""},model:{value:e.searchForm.orgCode,callback:function(t){e.$set(e.searchForm,"orgCode",t)},expression:"searchForm.orgCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"机构简称："}},[a("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"请填写",size:"small",clearable:""},model:{value:e.searchForm.orgShortName,callback:function(t){e.$set(e.searchForm,"orgShortName",t)},expression:"searchForm.orgShortName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"机构全称："}},[a("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"请填写",size:"small",clearable:""},model:{value:e.searchForm.orgName,callback:function(t){e.$set(e.searchForm,"orgName",t)},expression:"searchForm.orgName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"机构类型："}},[a("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"请选择"},model:{value:e.searchForm.orgType,callback:function(t){e.$set(e.searchForm,"orgType",t)},expression:"searchForm.orgType"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.orgTypeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.dictLabel,value:e.dictValue}})})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"状态："}},[a("el-select",{staticStyle:{width:"90px"},attrs:{placeholder:"请选择",clearable:"",size:"small"},model:{value:e.searchForm.orgStatus,callback:function(t){e.$set(e.searchForm,"orgStatus",t)},expression:"searchForm.orgStatus"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),a("el-option",{attrs:{value:"0",label:"正常"}}),e._v(" "),a("el-option",{attrs:{value:"2",label:"停用"}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.query(e.searchForm)}}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.resetForm}},[e._v("重置")])],1)],1):e._e(),e._v(" "),a("div",{directives:[{name:"auto-height",rawName:"v-auto-height"}],staticClass:"jee-table-box"},[a("v-tree-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"treeTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:"","sort-key":"orgSort",height:"100%"}},[a("tree-column",{attrs:{label:"（机构代码）机构简称","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            ( "+e._s(t.row.orgCode)+" )\n            "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.goEditOrg(t.row.uuid)}}},[e._v(e._s(t.row.orgShortName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"orgName",align:"center",label:"机构全称","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"orgSort",align:"center",label:"排序号","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"orgTypeName",align:"center",label:"机构类型","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"remarks",align:"center",label:"备注信息","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"orgStatus",align:"center",label:"状态","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return["0"===t.row.orgStatus?a("el-tag",{attrs:{type:"success",size:"mini"}},[e._v("正常")]):"2"===t.row.orgStatus?a("el-tag",{attrs:{type:"danger",size:"mini"}},[e._v("停用")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",fixed:"right","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.$permission["sys:org:edit"]?a("el-tooltip",{attrs:{"open-delay":400,effect:"light",content:"编辑机构",placement:"bottom-start"}},[a("el-button",{attrs:{type:"success-text",icon:"fa fa-pencil"},on:{click:function(a){e.goEditOrg(t.row.uuid)}}})],1):e._e(),e._v(" "),e.$permission["sys:org:status"]?["0"===t.row.orgStatus?a("el-tooltip",{attrs:{"open-delay":400,effect:"light",content:"停用机构",placement:"bottom-start"}},[a("el-button",{attrs:{type:"danger-text",icon:"fa fa-ban"},on:{click:function(a){e.stopOrg(t.row.uuid)}}})],1):e._e(),e._v(" "),"2"===t.row.orgStatus?a("el-tooltip",{attrs:{"open-delay":400,effect:"light",content:"启用机构",placement:"bottom-start"}},[a("el-button",{attrs:{type:"success-text",icon:"fa fa-play"},on:{click:function(a){e.startOrg(t.row.uuid)}}})],1):e._e()]:e._e(),e._v(" "),e.$permission["sys:org:delete"]?a("el-tooltip",{attrs:{"open-delay":400,effect:"light",content:"删除机构",placement:"bottom-start"}},[a("el-button",{attrs:{type:"danger-text",icon:"fa fa-trash-o"},on:{click:function(a){e.delOrg(t.row.uuid)}}})],1):e._e(),e._v(" "),e.$permission["sys:org:add"]?a("el-tooltip",{attrs:{"open-delay":400,effect:"light",content:"新增下级机构",placement:"bottom-start"}},[a("el-button",{attrs:{type:"primary-text",icon:"fa fa-plus-square"},on:{click:function(a){e.goAddOrg(t.row)}}})],1):e._e()]}}])})],1)],1)],1)])},staticRenderFns:[]};var g=a("VU/8")(f,d,!1,function(e){a("wZEn")},"data-v-0f28377a",null);t.default=g.exports},wZEn:function(e,t){}});