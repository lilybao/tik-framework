webpackJsonp([32],{Xj29:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Xxa5"),s=r.n(a),n=r("exGp"),o=r.n(n),i=r("RbaZ"),l=r("YMRc"),u={name:"RoleMenuAuth",props:{isEdit:{type:Boolean,default:!1}},data:function(){return{form:{roleName:"",roleCode:""},rules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}],roleCode:[{required:!0,message:"请输入角色编码",trigger:"blur"}]},treeData:[],treeProp:{children:"children",label:"menuName"}}},mounted:function(){var e=this;return o()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.queryMenuList();case 2:e.initForm();case 3:case"end":return t.stop()}},t,e)}))()},methods:{initForm:function(){this.$refs.form.resetFields(),this.$route.query.uuid?(this.getDetail(this.$route.query.uuid),this.getRoleMenu(this.$route.query.uuid)):this.jumpRouterCachedView(this.$route,{path:"/sys/role"})},getDetail:function(e){var t=this;return o()(s.a.mark(function r(){var a,n;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(l.x)({roleUuid:e});case 2:if("0000"===(a=r.sent).code&&a.data)for(n in a.data)a.data.hasOwnProperty(n)&&null!==a.data[n]&&(t.form[n]=a.data[n]);case 4:case"end":return r.stop()}},r,t)}))()},getRoleMenu:function(e){var t=this;return o()(s.a.mark(function r(){var a;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(l.y)({roleUuid:e});case 2:"0000"===(a=r.sent).code&&a.data&&t.$refs.tree.setCheckedKeys(a.data.map(function(e){return e.menuUuid}));case 4:case"end":return r.stop()}},r,t)}))()},queryMenuList:function(){var e=this;return o()(s.a.mark(function t(){var r,a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(l.A)();case 2:r=t.sent,a=Object(i.a)(r.data),e.treeData=[{uuid:0,menuName:"全部",children:Object(i.b)(a,"menuSort")}];case 5:case"end":return t.stop()}},t,e)}))()},save:function(){var e=this.$refs.tree.getHalfCheckedKeys().filter(function(e){return 0!==e}),t={roleUuid:this.form.uuid,menuUuidList:this.$refs.tree.getCheckedKeys().filter(function(e){return 0!==e}).concat(e)};this.submit(l.C,t)},submit:function(e,t){var r=this;return o()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(t);case 2:"0000"===a.sent.code&&(r.$message({type:"success",message:"操作成功"}),r.jumpRouterCachedView(r.$route,{path:"/sys/role"}));case 4:case"end":return a.stop()}},a,r)}))()},close:function(){this.jumpRouterCachedView(this.$route,{path:"/sys/role"})},foldTree:function(){this.toggleTree(!1)},openTree:function(){this.toggleTree(!0)},toggleTree:function(e){for(var t=0;t<this.$refs.tree.store._getAllNodes().length;t++)this.$refs.tree.store._getAllNodes()[t].expanded=e},handleCheckChange:function(e,t,r){console.log(e,t,r)}}},c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"jee-page"},[r("div",{staticClass:"jee-header"},[r("div",{staticClass:"jee-title"},[r("i",{class:e.$route.meta.icon}),e._v(" "+e._s(e.$route.meta.title))])]),e._v(" "),r("div",{staticClass:"jee-body"},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px",size:"small"}},[r("div",{staticClass:"jee-form-title"},[e._v("基本信息")]),e._v(" "),r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{offset:1,span:10}},[r("el-form-item",{attrs:{label:"角色名称：",prop:"roleName"}},[r("el-input",{attrs:{disabled:""},model:{value:e.form.roleName,callback:function(t){e.$set(e.form,"roleName",t)},expression:"form.roleName"}})],1)],1),e._v(" "),r("el-col",{attrs:{offset:1,span:10}},[r("el-form-item",{attrs:{label:"角色编码：",prop:"roleCode"}},[r("el-input",{attrs:{disabled:""},model:{value:e.form.roleCode,callback:function(t){e.$set(e.form,"roleCode",t)},expression:"form.roleCode"}})],1)],1)],1),e._v(" "),r("div",{staticClass:"jee-form-title"},[e._v("授权功能菜单")]),e._v(" "),r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"box-card-header clearfix",attrs:{slot:"header"},slot:"header"},[r("span",{staticClass:"fl"},[e._v("功能菜单")]),e._v(" "),r("div",{staticClass:"fr"},[r("span",{on:{click:e.openTree}},[e._v("展开")]),e._v(" / "),r("span",{on:{click:e.foldTree}},[e._v("折叠")])])]),e._v(" "),r("el-tree",{ref:"tree",attrs:{data:e.treeData,props:e.treeProp,"default-expanded-keys":[0],"node-key":"uuid","show-checkbox":""},on:{"check-change":e.handleCheckChange},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node;return r("span",{staticClass:"custom-tree-node",attrs:{title:a.label}},[e._v("\n            "+e._s(a.label)+"\n          ")])}}])})],1),e._v(" "),r("el-row",{staticClass:"jee-submit-buttons"},[r("el-col",{attrs:{offset:1,span:21}},[r("el-button",{attrs:{type:"primary",icon:"fa fa-check",size:"small"},on:{click:e.save}},[e._v("  保 存")]),e._v(" "),r("el-button",{attrs:{icon:"fa fa-reply-all",size:"small"},on:{click:e.close}},[e._v("  关 闭")])],1)],1)],1)],1)])},staticRenderFns:[]};var d=r("VU/8")(u,c,!1,function(e){r("oAhV")},"data-v-7f9aa210",null);t.default=d.exports},oAhV:function(e,t){}});