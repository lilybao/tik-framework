webpackJsonp([6],{SQFM:function(e,r){},mQvw:function(e,r,t){"use strict";var a=t("woOf"),o=t.n(a),s=t("Xxa5"),l=t.n(s),n=t("exGp"),i=t.n(n),u=t("Dd8w"),c=t.n(u),m=t("t5DY"),d=t("4w6b"),g=t("RbaZ"),p=t("E4LH"),f={orgShortName:[{required:!0,message:"请输入",trigger:"blur"},{max:16,message:"请输入不超过16个字符",trigger:"blur"}],orgName:[{required:!0,message:"请输入",trigger:"blur"},{max:50,message:"请输入不超过50个字符",trigger:"blur"}],orgCode:[{required:!0,message:"请输入",trigger:"blur"},{max:20,message:"请输入不超过20个字符",trigger:"blur"},{pattern:/^\w+$/,message:"只能包括英文字母、数字和下划线",trigger:"blur"}],orgType:[{required:!0,message:"请选择",trigger:"change"}],orgSort:[{validator:Object(p.b)(1,10),trigger:"blur"},{pattern:/^\d+$/,message:"只能包括数字",trigger:"blur"}],orgLeader:[{min:1,max:10,message:"请输入不超过10个字符",trigger:"blur"}],orgPhone:[{validator:p.d,trigger:"blur"}],orgAddress:[{max:50,message:"请输入不超过50个字符",trigger:"blur"}],orgPostalCode:[{max:6,message:"请输入不超过6个字符",trigger:"blur"},{pattern:/^\d+$/,message:"只能包括数字",trigger:"blur"}],remarks:[{max:150,message:"请输入不超过150个字符",trigger:"change"}]},h={name:"TypeForm",props:{isEdit:{type:Boolean,default:!1}},data:function(){var e=this;return{ruleForm:{},orgTypeList:[],orgAll:[],rules:c()({},f,{parentName:[{validator:function(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments[2];e.orgAll.length>0&&""!==t?e.orgAll.some(function(e){return e.orgName===t})?a():a(new Error("没有找到对应的机构")):a()},trigger:"blur"}]}),tableData:[],tree:[],defaultProps:{children:"children",label:"orgName"},currentNodeKey:"",loading:!1}},computed:{currentNodeKeys:function(){var e=[];return this.currentNodeKey&&(e[0]=this.currentNodeKey),e}},created:function(){var e=this;return i()(l.a.mark(function r(){return l.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:e.getOrgTypeList(),e.initForm();case 2:case"end":return r.stop()}},r,e)}))()},methods:{initForm:function(){var e=this.$route.query,r=e.parentUuid,t=e.orgName,a=e.uuid;a&&(this.uuid=a),"undefined"!==r&&"undefined"!==t&&(this.currentNodeKey=r,this.ruleForm=o()({},this.ruleForm,{parentUuid:r,parentName:t})),this.getOrgAll(a),this.isEdit&&this.getOrgDetail(a)},changeOrgName:function(){this.ruleForm.orgName||(this.$refs.ruleForm.clearValidate(["orgName"]),this.ruleForm=o()({},this.ruleForm,{orgName:this.ruleForm.orgShortName}))},treeShow:function(){this.currentNodeKey&&this.$refs.tree.setCurrentKey(this.currentNodeKey)},getOrgDetail:function(e){var r=this;return i()(l.a.mark(function t(){var a,o;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(d.c)({orgUuid:e});case 2:"0000"===(a=t.sent).code&&((o=a.data).parentOrg?(o.parentName=o.parentOrg.orgName,r.currentNodeKey=o.parentOrg.uuid,o.parentUuid=o.parentOrg.uuid,delete o.parentOrg):(o.parentName="",o.parentUuid=""),r.ruleForm=o);case 4:case"end":return t.stop()}},t,r)}))()},filterInput:function(){this.$refs.tree.filter(this.ruleForm.parentName)},filterNode:function(e,r,t){return!e||-1!==r.orgName.indexOf(e)},dataToTree:function(e,r){var t=[r];return Object(g.a)(e,t)},getOrgAll:function(e){var r=this;return i()(l.a.mark(function t(){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.c)();case 2:"0000"===(a=t.sent).code&&(r.orgAll=a.data,r.tree=r.dataToTree(a.data,e));case 4:case"end":return t.stop()}},t,r)}))()},getOrgTypeList:function(){var e=this;return i()(l.a.mark(function r(){var t;return l.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(m.b)("sys_org_type");case 2:"0000"===(t=r.sent).code&&(e.orgTypeList=t.data||[]);case 4:case"end":return r.stop()}},r,e)}))()},close:function(){this.jumpRouterCachedView(this.$route,{path:"/sys/org"})},handleNodeClick:function(e){this.ruleForm=o()({},this.ruleForm,{parentUuid:e.uuid,parentName:e.orgName})},validateSubmit:function(e){var r,t=this;this.$refs.ruleForm.validate((r=i()(l.a.mark(function r(a){return l.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!a){r.next=4;break}t.submit(e),r.next=5;break;case 4:return r.abrupt("return",!1);case 5:case"end":return r.stop()}},r,t)})),function(e){return r.apply(this,arguments)}))},submit:function(e){var r=this;return i()(l.a.mark(function t(){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.parentName||delete e.parentUuid,r.loading=!0,a=void 0,!r.isEdit){t.next=9;break}return t.next=6,Object(d.e)(e);case 6:a=t.sent,t.next=12;break;case 9:return t.next=11,Object(d.a)(e);case 11:a=t.sent;case 12:"0000"===a.code&&(r.$message({message:a.message,type:"success"}),r.jumpRouterView(r.$route,{path:"/sys/org"})),r.loading=!1;case 14:case"end":return t.stop()}},t,r)}))()}}},b={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("el-form",{ref:"ruleForm",staticClass:"jee-page",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"110px"}},[t("h3",{staticClass:"jee-page-h3-title"},[e._v("基本信息")]),e._v(" "),t("div",{staticClass:"first-section"},[t("el-row",[t("el-col",{attrs:{offset:1,span:10}},[t("el-form-item",{attrs:{label:"上级机构：",prop:"parentName"}},[t("el-popover",{attrs:{placement:"bottom-start",width:"300",trigger:"click"},on:{show:e.treeShow}},[t("el-tree",{ref:"tree",staticStyle:{width:"100%","max-height":"200px","overflow-y":"scroll"},attrs:{data:e.tree,"default-expanded-keys":e.currentNodeKeys,"filter-node-method":e.filterNode,"highlight-current":!0,props:e.defaultProps,"node-key":"uuid"},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(r){var a=r.node;return t("span",{staticClass:"custom-tree-node",attrs:{title:a.label}},[e._v("\n                "+e._s(a.label)+"\n              ")])}}])}),e._v(" "),t("el-input",{attrs:{slot:"reference",size:"small",clearable:""},on:{input:e.filterInput},slot:"reference",model:{value:e.ruleForm.parentName,callback:function(r){e.$set(e.ruleForm,"parentName",r)},expression:"ruleForm.parentName"}},[t("template",{slot:"append"},[t("span",{staticClass:"fa fa-search"})])],2)],1)],1)],1),e._v(" "),t("el-col",{attrs:{offset:1,span:10}},[t("el-form-item",{attrs:{label:"机构类型：",prop:"orgType"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"请选择"},model:{value:e.ruleForm.orgType,callback:function(r){e.$set(e.ruleForm,"orgType",r)},expression:"ruleForm.orgType"}},e._l(e.orgTypeList,function(e,r){return t("el-option",{key:r,attrs:{label:e.dictLabel,value:e.dictValue}})}))],1)],1)],1),e._v(" "),t("el-row",[t("el-col",{attrs:{offset:1,span:10}},[t("el-form-item",{attrs:{label:"机构名称：",prop:"orgShortName"}},[t("el-input",{attrs:{size:"small",maxlength:"16",clearable:""},on:{blur:e.changeOrgName},model:{value:e.ruleForm.orgShortName,callback:function(r){e.$set(e.ruleForm,"orgShortName",r)},expression:"ruleForm.orgShortName"}})],1)],1),e._v(" "),t("el-col",{attrs:{offset:1,span:10}},[t("el-form-item",{attrs:{label:"机构代码：",prop:"orgCode"}},[t("el-input",{attrs:{size:"small",maxlength:"20",clearable:""},model:{value:e.ruleForm.orgCode,callback:function(r){e.$set(e.ruleForm,"orgCode",r)},expression:"ruleForm.orgCode"}})],1)],1)],1),e._v(" "),t("el-row",[t("el-col",{attrs:{offset:1,span:10}},[t("el-form-item",{attrs:{label:"机构全称：",prop:"orgName"}},[t("el-input",{attrs:{size:"small",maxlength:"50",clearable:""},model:{value:e.ruleForm.orgName,callback:function(r){e.$set(e.ruleForm,"orgName",r)},expression:"ruleForm.orgName"}})],1)],1),e._v(" "),t("el-col",{attrs:{offset:1,span:10}},[t("el-form-item",{attrs:{label:"排序号：",prop:"orgSort"}},[t("el-input",{attrs:{type:"number",size:"small",maxlength:"9",clearable:"",placeholder:"排序号越大排名越靠后，请填写数字"},model:{value:e.ruleForm.orgSort,callback:function(r){e.$set(e.ruleForm,"orgSort",e._n(r))},expression:"ruleForm.orgSort"}})],1)],1)],1)],1),e._v(" "),t("h3",{staticClass:"jee-page-h3-title"},[e._v("详细信息")]),e._v(" "),t("div",{staticClass:"first-section"},[t("el-row",[t("el-col",{attrs:{offset:1,span:10}},[t("el-form-item",{attrs:{label:"负责人：",prop:"orgLeader"}},[t("el-input",{attrs:{size:"small",maxlength:"10",clearable:""},model:{value:e.ruleForm.orgLeader,callback:function(r){e.$set(e.ruleForm,"orgLeader",r)},expression:"ruleForm.orgLeader"}})],1)],1),e._v(" "),t("el-col",{attrs:{offset:1,span:10}},[t("el-form-item",{attrs:{label:"办公电话：",prop:"orgPhone"}},[t("el-input",{attrs:{size:"small",clearable:""},model:{value:e.ruleForm.orgPhone,callback:function(r){e.$set(e.ruleForm,"orgPhone",r)},expression:"ruleForm.orgPhone"}})],1)],1)],1),e._v(" "),t("el-row",[t("el-col",{attrs:{offset:1,span:10}},[t("el-form-item",{attrs:{label:"联系地址：",prop:"orgAddress"}},[t("el-input",{attrs:{size:"small",maxlength:"50",clearable:""},model:{value:e.ruleForm.orgAddress,callback:function(r){e.$set(e.ruleForm,"orgAddress",r)},expression:"ruleForm.orgAddress"}})],1)],1),e._v(" "),t("el-col",{attrs:{offset:1,span:10}},[t("el-form-item",{attrs:{label:"邮政编码：",prop:"orgPostalCode"}},[t("el-input",{attrs:{size:"small",maxlength:"6",clearable:""},model:{value:e.ruleForm.orgPostalCode,callback:function(r){e.$set(e.ruleForm,"orgPostalCode",r)},expression:"ruleForm.orgPostalCode"}})],1)],1)],1),e._v(" "),t("el-row",[t("el-col",{attrs:{offset:1,span:21}},[t("el-form-item",{attrs:{label:"备注信息：",prop:"remarks"}},[t("el-input",{attrs:{type:"textarea",size:"small",rows:"3"},model:{value:e.ruleForm.remarks,callback:function(r){e.$set(e.ruleForm,"remarks",r)},expression:"ruleForm.remarks"}})],1)],1)],1)],1),e._v(" "),t("el-row",{staticClass:"jee-submit-buttons",staticStyle:{"padding-left":"116px"}},[t("el-col",{attrs:{offset:1,span:21}},[t("el-button",{staticClass:"fa fa-check",attrs:{loading:e.loading,type:"primary",size:"small"},on:{click:function(r){e.validateSubmit(e.ruleForm)}}},[e._v("\n        保存\n      ")]),e._v(" "),t("el-button",{staticClass:"fa fa-reply-all",attrs:{size:"small"},on:{click:e.close}},[e._v("\n        关闭\n      ")])],1)],1)],1)},staticRenderFns:[]};var v=t("VU/8")(h,b,!1,function(e){t("SQFM")},"data-v-f58bf1e4",null);r.a=v.exports},mpJO:function(e,r){},u3rr:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={name:"OrgEdit",components:{TypeForm:t("mQvw").a},data:function(){return{}},methods:{}},o={render:function(){var e=this.$createElement,r=this._self._c||e;return r("div",{staticClass:"org-edit jee-page"},[r("div",{staticClass:"jee-header"},[r("div",{staticClass:"jee-title"},[r("i",{class:this.$route.meta.icon}),this._v(" "+this._s(this.$route.meta.title))])]),this._v(" "),r("div",{staticClass:"jee-page-container",staticStyle:{height:"calc(100% - 50px)"}},[r("TypeForm",{attrs:{"is-edit":!0}})],1)])},staticRenderFns:[]};var s=t("VU/8")(a,o,!1,function(e){t("mpJO")},"data-v-6d84bd88",null);r.default=s.exports}});